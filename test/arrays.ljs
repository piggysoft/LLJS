let assert = require("assert");

extern describe, it, console;

describe('Arrays', function() {
  function testElements(int * a, int length) {
    for (let int i = 0; i < length; i++) {
        a[i] = i;
    }
    let int sum = 0;
    for (let int i = 0; i < length; i++) {
      sum += a[i];
    }
    assert (sum === ((length * (length - 1)) / 2));
  }

  it('allocates an array on the heap', function () {
    testElements(new int [1024], 1024);
  });

  it('allocates an array on the stack', function () {
    let int a [1024];
    testElements(a, 1024);
  });

  it('int', function () {
    let int a [1024];
    testElements(a, 1024);
   });
});

describe('Stack Arrays', function() {
  it('u8', function () {
    let u8 a [1024];
    a[42] = 42;
    assert (a[42] === 42);
    assert (*(a + 42) === 42);
    a[42] = 0xFFAD;
    assert (*(a + 42) === 0xAD);
    a[12] = -1;
    assert (a[12] === 255);
  });
  it('i8', function () {
    let i8 a [1024];
    a[42] = -42;
    assert (a[42] === -42);
    assert (*(a + 42) === -42);
    *(a + 42) = 0xFFAE;
    assert (*(a + 42) === -82);
    a[12] = -1;
    assert (a[12] === -1);
  });
});