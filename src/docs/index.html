<html>
  <head>
    <title>JC</title>
    <link rel="stylesheet" type="text/css" href="css/docs.css" />
  </head>
  <script>
    print = function (x) {
      console.info(x);
    }
  </script>
  <script src="vendor/jquery-1.6.4.js"></script>
  <script src="jc/util.js"></script>
  <script src="jc/parser.js"></script>
  <script src="jc/compiler.js"></script>
  <body>
    <div id="flybar">
      <a id="logo" href="#top"></a>
      <div class="navigation toc">
        <div class="button">
          Table of Contents
        </div>
        <div class="contents menu">
          <a href="#overview">Overview</a>
          <a href="#installation">Installation</a>
          <a href="#usage">Usage</a>
          <a href="#language">Language Reference</a>
        </div>
      </div>
      <div class="navigation try">
        <div class="button">
          Try JC
          <div class="repl_bridge"></div>
        </div>
        <div class="contents repl_wrapper">
          <div class="code">
            <div class="screenshadow tl"></div>
            <div class="screenshadow tr"></div>
            <div class="screenshadow bl"></div>
            <div class="screenshadow br"></div>
            <div id="repl_source_wrap">
              <textarea id="repl_source" rows="100" spellcheck="false">int x;</textarea>
            </div>
            <div id="repl_results_wrap"><pre id="repl_results"></pre></div>
            <div class="minibutton dark run" title="Ctrl-Enter">Run</div>
            <a class="minibutton permalink" id="repl_permalink">Link</a>
            <br class="clear" />
          </div>
        </div>
      </div>
      <div id="error" style="display:none;"></div>
    </div>
    <div class="container">
      <span class="bookmark" id="top"></span>
      <h2>
        <span id="overview" class="bookmark"></span>
        Overview
      </h2>
    </div>
    <script>
      function closeMenus() {
        $('.navigation.active').removeClass('active')
      }

      function compileSource() {
        var jcSrc = $('#repl_source').val();
        try {
          var jsSrc = compile(jcSrc);
          var res = $('#repl_results')[0];
          res.innerText = jsSrc;
        } catch (x) {
          $('#error').text(x.message).show()
        }
      }

      $('#repl_source').keyup(function () {
        compileSource();
      });

      function evalJS() {
        try {
          eval(window.compiledJS);
        } catch (x) {
          alert (x.message);
        }
      }

      $('.minibutton.run').click(function () {
        evalJS();
      });

      $('.navigation').click(function (e) {
        if (e.target.tagName.toLowerCase() === 'a') {
          return;
        }
        if ($(e.target).closest('.repl_wrapper').length) {
          return false;
        }
        if ($(this).hasClass('active')) {
          closeMenus();
        } else {
          closeMenus()
          $(this).addClass('active')
        }
      });

    </script>
  </body>
</html>
